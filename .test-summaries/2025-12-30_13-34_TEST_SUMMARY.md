# Test Summary: FAIL ❌

2025-12-30 13:34 - 2 Python files, 5 selftest endpoints

## All Results

### Python Test Files
- ✅ OK: `./src/routers_v2/common_report_functions_v2_test.py` (68 tests)
- ❌ FAIL: `./src/routers_v2/common_sharepoint_functions_v2_test.py` (missing credentials)

### Selftest Endpoints
- ✅ OK: `/openaiproxyselftest` (38 tests, 1 warning)
- ✅ OK: `/v2/demorouter1/selftest` (42 tests)
- ✅ OK: `/v2/demorouter2/selftest` (18 tests)
- ✅ OK: `/v2/domains/selftest` (29 tests)
- ✅ OK: `/v2/jobs/selftest` (46 tests)

## Failed Tests

### common_sharepoint_functions_v2_test.py - FAIL ❌ (missing credentials)

```
ERROR: Missing required credentials:
  - CRAWLER_CLIENT_ID
  - CRAWLER_TENANT_ID
  - CRAWLER_CLIENT_CERTIFICATE_PFX_FILE
  - CRAWLER_CLIENT_CERTIFICATE_PASSWORD

RESULT: FAIL (missing credentials)
```

## Warnings

### /openaiproxyselftest - WARNING ⚠️ (1 test with undocumented behavior)

```
⚠️ OK (undocumented chunks-only format): /vector_stores/{id}/files/{file_id}/content (GET)
  - Test passed but returned undocumented chunks-only format instead of expected file content format
  - vector_store_id: 'vs_6953c5d4e23881919fbe247875bb3fdb'
  - chunks_count: 1
  - first_chunk: 'Arilena Drovik was born 1987-05-03'
```

## Action Required

### 2025-12-30_13-34_TEST_FAIL_001

- **File -> Test**: `./src/routers_v2/common_sharepoint_functions_v2_test.py` -> `Environment Setup`
- **What is it testing?**: The entire SharePoint functions test suite requires valid SharePoint crawler credentials to connect to SharePoint Online
- **Why did it fail?**: Environment variables for SharePoint crawler credentials are not configured in the current environment:
  - `CRAWLER_CLIENT_ID` - Azure AD app client ID with SharePoint permissions
  - `CRAWLER_TENANT_ID` - Azure AD tenant ID
  - `CRAWLER_CLIENT_CERTIFICATE_PFX_FILE` - Certificate file path for authentication
  - `CRAWLER_CLIENT_CERTIFICATE_PASSWORD` - Certificate password
- **Fix Option A (recommended)**: Set up the required environment variables with valid SharePoint crawler credentials. These should match the credentials used in the Azure/SharePoint environment you're testing against
- **Fix Option B**: Skip this test file in environments where SharePoint credentials are not available (e.g., CI/CD pipelines, local development without access to SharePoint)

### 2025-12-30_13-34_WARN_001

- **File -> Test**: `/openaiproxyselftest` -> `GET /vector_stores/{id}/files/{file_id}/content`
- **What is it testing?**: Retrieving the raw content of a file from a vector store
- **Why is there a warning?**: The endpoint returned data successfully but in an undocumented "chunks-only" format. The test expected standard file metadata (filename, file_id) but received only chunk data
- **Fix Option A (recommended)**: Update the API to return the standard documented format with file metadata alongside chunks
- **Fix Option B**: Document this chunks-only format as the expected response format and update the test expectations accordingly
